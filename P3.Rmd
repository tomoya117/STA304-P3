---
title: "P3"
output: pdf_document
---

```{r}
library(tidyverse)
library(knitr)
library(dplyr)
library(kableExtra)
```

```{r}
finance <- read_csv("Table 16.1_proportion-Table 1.csv")
finance <- data.frame(finance)
finance <- subset(finance, select = c(1, 2, 3, 4, 5, 6))
finance <- finance[c(8, 9, 11, 12, 14, 15), ]
colnames(finance) <- c('Description', '2006', '2010', '2014', '2019', '2020')
```
```{r}
demographics <- read_csv(file = "GSS_Table1.csv")
demographics <- data.frame(demographics)
demographics <- subset(demographics, select = c(1, 2, 3, 4, 6, 7, 8))
demographics <- demographics[c(95:99), ]
colnames(demographics) <- c('Age Group', '2019_Male', '2019_Female', '2019_Total', '2020_Male', '2020_Female', '2020_Total')
demographics <- 
  demographics |>
  select(`Age Group`, `2019_Male`, `2019_Female`, `2019_Total`, `2020_Male`, `2020_Female`, `2020_Total`) |>
  mutate(`2019_Total` = gsub(",", "", `2019_Total`)) |>
  mutate(`2019_Male` = gsub(",", "", `2019_Male`)) |>
  mutate(`2019_Female` = gsub(",", "", `2019_Female`)) |>
  mutate(`2020_Total` = gsub(",", "", `2020_Total`)) |>
  mutate(`2020_Male` = gsub(",", "", `2020_Male`)) |>
  mutate(`2020_Female` = gsub(",", "", `2020_Female`)) |>
  mutate(`2019_Other` = as.numeric(`2019_Total`) - as.numeric(`2019_Male`) - as.numeric(`2019_Female`)) |> 
  mutate(`2020_Other` = as.numeric(`2020_Total`) - as.numeric(`2020_Male`) - as.numeric(`2020_Female`))
```
```{r}
demographics |>
  select(`Age Group`, `2019_Male`, `2019_Female`,  `2019_Other`, `2019_Total`, `2020_Male`, `2020_Female`, `2020_Other`, `2020_Total`) |>
  slice(1:5) |>
  kable(
    caption = "Demographics of the Survey Respondents", 
    col.names = c("Age Group", "Male", "Female", "Other", "Total", "Male", "Female", "Other", "Total"),
    digits = 1,
    booktabs = TRUE, 
    linesep = ""
  ) |>  
  add_header_above(c(" " = 1, "2019" = 4, "2020" = 4))
```
```{r}
age <- 
  demographics |>
  select(`Age Group`, `2019_Total`, `2020_Total`) |>
  gather(Total, Count, 2:3)
```
```{r}
age |> 
  ggplot(aes(x = `Age Group`, y = Count, group = Total, fill = Total)) +
  geom_col(position = "dodge", alpha = 0.8) +
  theme_minimal() + 
  labs(x = "Age Group", title = "Figure 4: Survey Respondent's Age", caption = "General Social Survey: Summary Results, Australia") + scale_fill_discrete(labels = c("2019", "2020"))
```
```{r}
gender <- 
  demographics |>
  select(`2019_Male`, `2019_Female`, `2019_Other`, `2020_Male`, `2020_Female`, `2020_Other`) |>
  gather(Gender, Count, 1:6)

gender <- 
  gender |>
  select(Gender, Count) |>
  mutate(Year = 
           case_when(Gender == "2019_Male" ~ "2019", 
                     Gender == "2019_Female" ~ "2019",
                     Gender == "2019_Other" ~ "2019",
                     Gender == "2020_Male" ~ "2020", 
                     Gender == "2020_Female" ~ "2020", 
                     Gender == "2020_Other" ~ "2020")) |>
  mutate(Gender = 
           case_when(Gender == "2019_Male" ~ "Male", 
                     Gender == "2019_Female" ~ "Female",
                     Gender == "2019_Other" ~ "Other",
                     Gender == "2020_Male" ~ "Male", 
                     Gender == "2020_Female" ~ "Female",
                    Gender == "2020_Other" ~ "Other"))
```
```{r}
gender |> 
  ggplot(aes(x = Gender, y = Count, group = Year, fill = Year)) +
  geom_col(position = "dodge", alpha = 0.8) +
  theme_minimal() + 
  labs(x = "Gender", title = "Figure 5: Survey Respondent's Gender Distribution", caption = "General Social Survey: Summary Results, Australia") + scale_fill_discrete(labels = c("2019", "2020"))
```





